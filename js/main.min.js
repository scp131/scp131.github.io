!function(t,e){var i,n,s=e.body,o=e.querySelector.bind(e),a=e.querySelectorAll.bind(e),l=o("html"),c=o("#gotop"),r=o("#menu"),d=o("#header"),h=o("#mask"),f=o("#menu-toggle"),u=o("#menu-off"),m=o("#loading"),g=t.requestAnimationFrame,v=Array.prototype.forEach,L="ontouchstart"in t&&/Mobile|Android|iOS|iPhone|iPad|iPod|Windows Phone|KFAPWI/i.test(navigator.userAgent)?"touchstart":"click",p=/micromessenger/i.test(navigator.userAgent),E=function(){},$=function(){return e.documentElement.scrollTop||e.body.scrollTop},S={goTop:function(e){var i=$(),n=arguments.length>2?arguments[1]:Math.abs(i-e)/12;i&&i>e?(t.scrollTo(0,Math.max(i-n,0)),g(arguments.callee.bind(this,e,n))):e&&i<e?(t.scrollTo(0,Math.min(i+n,e)),g(arguments.callee.bind(this,e,n))):null!=this.toc&&this.toc.actived(e)},toggleGotop:function(e){e>t.innerHeight/2?c.classList.add("in"):c.classList.remove("in")},toggleMenu:function(e){var i=o("#main");if(e){if(r.classList.remove("hide"),t.innerWidth<1241)if(h.classList.add("in"),r.classList.add("show"),p){var n=$();i.classList.add("lock"),i.scrollTop=n}else l.classList.add("lock")}else if(r.classList.remove("show"),h.classList.remove("in"),p){n=i.scrollTop;i.classList.remove("lock"),t.scrollTo(0,n)}else l.classList.remove("lock")},fixedHeader:function(t){t>d.clientHeight?d.classList.add("fixed"):d.classList.remove("fixed")},initHeaderLink:function(){for(let t=1;t<=6;t++)v.call(document.querySelectorAll(".post-card .post-content > h"+t),(function(t){t.insertAdjacentHTML("afterbegin",`<a href="#${t.id}" class="headerlink"></a>`)}))},toc:function(){if(t.BLOG.SINGLE){var e=document.getElementById("TableOfContents"),i=o("#post-toc"),n=o(".post-header").clientHeight,s=d.clientHeight,a=e.querySelectorAll("a:first-child"),l=e.getElementsByTagName("li"),c=document.getElementsByClassName("headerlink");return v.call(l,(function(t){t.classList.add("has-active")})),document.getElementById("post-toc").appendChild(e),this._tocOnScroll=this._tocOnScroll||(()=>{v.call(a,(function(t){t.classList.remove("active")})),v.call(l,(function(t){t.classList.remove("has-active")}));let t=c.length-1;for(let e=0;e<c.length-1;e++){var i=c[e].getBoundingClientRect().top,n=c[e+1].getBoundingClientRect().top,s=20+d.offsetHeight;if(0==e&&i>s||i<=s&&n>s){t=e;break}}if(-1!==t){a[t].classList.add("active");let i=a[t].parentElement;for(;i!==e;)i.classList.add("has-active"),i=i.parentElement.parentElement}}),this._tocOnScroll(),t.addEventListener("scroll",(()=>{this._tocOnScroll(),o("#post-toc").scrollTop=null==o("#post-toc a.active")?0:o("#post-toc a.active").offsetTop}),!1),{fixed:function(t){t>=n-s?i.classList.add("fixed"):i.classList.remove("fixed")},actived:function(t){i.classList.remove("post-toc-shrink")}}}}(),hideOnMask:[],modal:function(t){this.$modal=o(t),this.$off=this.$modal.querySelector(".close");var e=this;this.show=function(){h.classList.add("in"),e.$modal.classList.add("ready"),setTimeout((function(){e.$modal.classList.add("in")}),0)},this.onHide=E,this.hide=function(){e.onHide(),h.classList.remove("in"),e.$modal.classList.remove("in"),setTimeout((function(){e.$modal.classList.remove("ready")}),300)},this.toggle=function(){return e.$modal.classList.contains("in")?e.hide():e.show()},S.hideOnMask.push(this.hide),this.$off&&this.$off.addEventListener(L,this.hide)},share:function(){var t=o("#pageShare"),i=o("#shareFab"),n=new this.modal("#globalShare");o("#menuShare").addEventListener(L,n.toggle),i&&(i.addEventListener(L,(function(){t.classList.toggle("in")}),!1),e.addEventListener(L,(function(e){!i.contains(e.target)&&t.classList.remove("in")}),!1));var s=new this.modal("#wxShare");s.onHide=n.hide,v.call(a(".wxFab"),(function(t){t.addEventListener(L,s.toggle)}))},search:function(){var t=o("#search-wrap");o("#search").addEventListener(L,(function(){t.classList.toggle("in")}))},waterfall:function(){t.innerWidth<760||v.call(a(".waterfall"),(function(t){t.classList.add("in")}))},smoothScroll:function(){SmoothScroll&&new SmoothScroll('[href^="#"]',{speed:300,speedAsDuration:!0})},tabBar:function(t){t.parentNode.parentNode.classList.toggle("expand")},page:(i=a(".fade, .fade-scale"),n=!1,{loaded:function(){v.call(i,(function(t){t.classList.add("in")})),n=!0},unload:function(){v.call(i,(function(t){t.classList.remove("in")})),n=!1},visible:n}),lightbox:function(){function i(i){var n,o,a,l,c;this.$img=i.querySelector("img"),this.$overlay=i.querySelector("overlay"),this.margin=40,this.title=this.$img.title||this.$img.alt||"",this.isZoom=!1,this.calcRect=function(){l=s.clientWidth;var t=(c=s.clientHeight)-2*this.margin,e=n,i=o,r=(this.margin,e>l?l/e:1),d=i>t?t/i:1,h=Math.min(r,d);return{w:e*=h,h:i*=h,t:(c-i)/2-a.top,l:(l-e)/2-a.left+this.$img.offsetLeft}},this.setImgRect=function(t){this.$img.style.cssText="width: "+t.w+"px; max-width: "+t.w+"px; height:"+t.h+"px; top: "+t.t+"px; left: "+t.l+"px"},this.setFrom=function(){this.setImgRect({w:a.width,h:a.height,t:0,l:(i.offsetWidth-a.width)/2})},this.setTo=function(){this.setImgRect(this.calcRect())},this.addTitle=function(){this.title&&(this.$caption=e.createElement("div"),this.$caption.innerHTML=this.title,this.$caption.className="overlay-title",i.appendChild(this.$caption))},this.removeTitle=function(){this.$caption&&i.removeChild(this.$caption)};var r=this;this.zoomIn=function(){n=this.$img.naturalWidth||this.$img.width,o=this.$img.naturalHeight||this.$img.height,a=this.$img.getBoundingClientRect(),i.style.height=a.height+"px",i.classList.add("ready"),this.setFrom(),this.addTitle(),this.$img.classList.add("zoom-in"),setTimeout((function(){i.classList.add("active"),r.setTo(),r.isZoom=!0}),0)},this.zoomOut=function(){this.isZoom=!1,i.classList.remove("active"),this.$img.classList.add("zoom-in"),this.setFrom(),setTimeout((function(){r.$img.classList.remove("zoom-in"),r.$img.style.cssText="",r.removeTitle(),i.classList.remove("ready"),i.removeAttribute("style")}),300)},i.addEventListener("click",(function(t){r.isZoom?r.zoomOut():"IMG"===t.target.tagName&&r.zoomIn()})),e.addEventListener("scroll",(function(){r.isZoom&&r.zoomOut()})),t.addEventListener("resize",(function(){r.isZoom&&r.zoomOut()}))}t.BLOG.SINGLE&&v.call(a(".img-lightbox"),(function(t){new i(t)}))}(),loadScript:function(t){t.forEach((function(t){var i=e.createElement("script");i.src=t,i.async=!0,s.appendChild(i)}))}};t.addEventListener("load",(function(){m.classList.remove("active"),S.page.loaded(),t.lazyScripts&&t.lazyScripts.length&&S.loadScript(t.lazyScripts)})),t.addEventListener("DOMContentLoaded",(function(){if(S.waterfall(),t.BLOG.SINGLE){S.initHeaderLink();var e=$();S.toc.fixed(e),S.toc.actived(e)}S.page.loaded()}));var y=!1,w=o('a[href^="mailto"]');w&&w.addEventListener(L,(function(){y=!0})),t.addEventListener("beforeunload",(function(t){y?y=!1:S.page.unload()})),t.addEventListener("pageshow",(function(){!S.page.visible&&S.page.loaded()})),t.addEventListener("resize",(function(){t.BLOG.even=L="ontouchstart"in t?"touchstart":"click",S.toggleMenu(),S.waterfall()})),c.addEventListener(L,(function(){g(S.goTop.bind(S,0))}),!1),f.addEventListener(L,(function(t){S.toggleMenu(!0),t.preventDefault()}),!1),u.addEventListener(L,(function(){r.classList.add("hide")}),!1),h.addEventListener(L,(function(t){S.toggleMenu(),S.hideOnMask.forEach((function(t){t()})),t.preventDefault()}),!1),e.addEventListener("scroll",(function(){var e=$();S.toggleGotop(e),S.fixedHeader(e),t.BLOG.SINGLE&&(S.toc.fixed(e),S.toc.actived(e))}),!1),S.share(),t.BLOG.SINGLE&&S.smoothScroll(),S.noop=E,S.even=L,S.$=o,S.$$=a,Object.keys(S).reduce((function(t,e){return t[e]=S[e],t}),t.BLOG),t.Waves?(Waves.init(),Waves.attach(".global-share li",["waves-block"]),Waves.attach(".article-tag-list-link, #page-nav a, #page-nav span",["waves-button"])):console.error("Waves loading failed.")}(window,document);